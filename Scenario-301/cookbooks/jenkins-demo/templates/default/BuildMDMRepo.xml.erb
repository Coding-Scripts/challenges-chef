<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description></description>
  <logRotator class="hudson.tasks.LogRotator">
    <daysToKeep>-1</daysToKeep>
    <numToKeep>50</numToKeep>
    <artifactDaysToKeep>-1</artifactDaysToKeep>
    <artifactNumToKeep>-1</artifactNumToKeep>
  </logRotator>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.security.AuthorizationMatrixProperty>
      <permission>hudson.model.Item.Read:anonymous</permission>
    </hudson.security.AuthorizationMatrixProperty>
    <com.chikli.hudson.plugin.naginator.NaginatorOptOutProperty plugin="naginator@1.17.2">
      <optOut>false</optOut>
    </com.chikli.hudson.plugin.naginator.NaginatorOptOutProperty>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <hudson.model.StringParameterDefinition>
          <name>working_dir</name>
          <description>Working directory for the code build.</description>
          <defaultValue><%= node['jenkins_mdm']['buildrepo_dir'] %></defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>framework_git_repo_url</name>
          <description>Repo url for framework code.</description>
          <defaultValue>git@github.com:TOTVS/totvslabs-framework.git</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>git_repo_url</name>
          <description>Repo url for source code.</description>
          <defaultValue>git@github.com:TOTVS/mdm.git</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>framework_branch_name</name>
          <description>Which framework branch to build.</description>
          <defaultValue>master</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>app_branch_name</name>
          <description>Which branch to build.</description>
          <defaultValue>master</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.TextParameterDefinition>
          <name>files_to_copy</name>
          <description>List files are generated by the build process and necessary for the prod env.
</description>
          <defaultValue>mdm/app/target/app-*.jar
mdm/app/*.jks
mdm/app/FluigIdentity.pk8
mdm/plugins/mdm-bematech-plugin/target/mdm-bematech-plugin-*-SNAPSHOT.jar
mdm/plugins/mdm-backupserver-plugin/target/mdm-backupserver-plugin-*.jar
totvslabs-framework/backupserver/target/backupserver-*.jar
mdm/build_version</defaultValue>
        </hudson.model.TextParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>skip_test</name>
          <description>If checked, skip unit test</description>
          <defaultValue>true</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>force_build</name>
          <description>Whether to force code build, even it no new commit ever since last build. If configured as false, the job can speed up by avoiding unnecessary build.</description>
          <defaultValue>true</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>clean_start</name>
          <description>If checked, remove the directory of old code, which may be git clone before.</description>
          <defaultValue>false</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>enable_npm_log</name>
          <description>When code build whether enable npm logging.</description>
          <defaultValue>false</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>show_mvn_dependencies</name>
          <description>During code build, whether show maven package dependencies.</description>
          <defaultValue>false</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>old_build_retention_days</name>
          <description>Code build for every different branch will use ~1GB. We enforce data retention to reclaim disk capacity.

This would be useful for long-run env</description>
          <defaultValue><%= node['jenkins_mdm']['data_rentention_days'] %></defaultValue>
        </hudson.model.StringParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <canRoam>true</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <concurrentBuild>false</concurrentBuild>
  <triggers/>
  <builders>
    <hudson.tasks.Shell>
      <command>#!/bin/bash -ex
# https://github.com/TOTVS/mdmdevops/blob/master/cookbooks/jenkins-demo/files/default/mdm_build_code.sh
bash -xe /var/lib/jenkins/code/scripts/mdm_build_code.sh
</command>
</hudson.tasks.Shell>
  </builders>
    <publishers>
    <com.chikli.hudson.plugin.naginator.NaginatorPublisher plugin="naginator@1.17.2">
      <regexpForRerun></regexpForRerun>
      <rerunIfUnstable>false</rerunIfUnstable>
      <rerunMatrixPart>false</rerunMatrixPart>
      <checkRegexp>false</checkRegexp>
      <regexpForMatrixStrategy>TestParent</regexpForMatrixStrategy>
      <delay class="com.chikli.hudson.plugin.naginator.FixedDelay">
        <delay>10</delay>
      </delay>
      <maxSchedule>1</maxSchedule>
    </com.chikli.hudson.plugin.naginator.NaginatorPublisher>
  </publishers>
  <buildWrappers/>
</project>
